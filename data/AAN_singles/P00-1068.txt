Diagnostic Processing of Japanese forComputer-Assisted Second Language LearningJun?ichi Kakegawa, Hisayuki Kanda, Eitaro Fujioka, Makoto Itami, Kohji ItohDepartment of Applied Electronics,Science University of Tokyo2641 Yamazaki, Noda-shi, Chiba-ken 278-8510, JAPANfkakegawa,kanda,eitaro76,itami,itohg@itlb.te.noda.sut.ac.jpAbstractAs an application of NLP tocomputer-assisted language learn-ing(CALL) , we propose a diag-nostic processing of Japanese be-ing able to detect errors and inap-propriateness of sentences composedby the students in the given situ-ation and the context of the exer-cise texts.
Using LTAG(LexicalizedTree Adjoining Grammar) formal-ism, we have implemented a proto-type of such a diagnostic parser as acomponent of a CALL system beingdeveloped.1 IntroductionIn the recent classroom of second languagelearning, communicative approach(H.G.
Wid-dowson, 1977) is promoted in which it mat-ters for the students to become aware of thelanguage use, i.e.
the functionality of lan-guage usage and it?s dependence on the sit-uations and the contexts of communication.In order to achieve the objective accordingto \constructivistic" point of view of learning(T.M.Duy et al, 1991), the students are en-couraged to produce sentences by themselvesin various situations and contexts and guidedto recognize by themselves the erroneous orinappropriate functions of their misused ex-pressions.We have already proposed a Computer-Assisted Language Learning(CALL) system(N.Kato et al, 1997) which provides the stu-dents with sample texts promoting their re-flection on the errors and inappropriateness,detected by a diagnostic parser, of the sen-tences composed by the students lling theblanks set up in the given contexts and situ-ations.
In this paper we report on prototyp-ing the diagnostic parser implemented usingLTAG formalism as a component of the sys-tem.LTAG(Lexicalized Tree Adjoining Gram-mar) is a lexicalized grammatical formalism(XTAG Research Group, 1995).
For easeof diagnosing the erroneous sentences com-posed by the students, lexicalized type ofgrammars seemed most suitable.
ComparingHPSG(Head-driven Phrase Structure Gram-mar) (C.Pollard et al, 1994) and LTAG,the well-known two (almost-)lexicalized gram-mars, LTAG looked more simple and espe-cially convenient for sentence generation nec-essary in diagnosis.
LTAG systematically as-sociates an elementary tree structure with alexical anchor and the structure is embeddedin the corresponding lexical item.
Associatedwith each of the external nodes of the embed-ded tree structure are feature structures suchas inflection, case information, head symbol,semantic constraints as well as a dierencelist for surface expressions.
These featureshave their origin in the anchored lexical item.The feature information can, moreover, in-clude the knowledge of situated language use.Appearance of the features at the externalnodes of the lexical items greatly facilitatesgeneration of local phrases which is indispens-able in diagnostic parsing.
These are the rea-son why we employed LTAG.Preference of unication to all-proceduralhandling excluded the so-called \ dependencygrammar "(M.Nagao, 1996).2 LTAG of Japanese2.1 The Characteristic of JapaneseJapanese phrases are classied in therst place into two categories: Yougenphrase(YP) and Taigen phrase(TP).
A YPor TP has a Yougen or a Taigen, respectively,as it?s head word.
Yougen along with Taigenas categories belong to the category of se-mantically self-contained (called autonomous)words.
The words, e.g.
verbs, adjectives, be-longing to Yougen have inflections, whereasthe words.
e.g.
nouns, pronouns, demonstra-tives, belonging to Taigen have no inflection.A YP or TP consists of a head word and itssibling phrases on it?s left semantically modi-fying the head word.
And such a phrase in itsturn can semantically modify an autonomousword by way of attaching a connective to it?sright, forming a phrase, or inflecting the headword of the modier.In general, a sentence is constructed by at-taching to a phrase a few (or void of) func-tional words expressing the attitude of the lo-cutor to the proposional part of the phrase( modality ) and intention of the locution af-fecting the listener ( illocutionary-act marking).2.2 Elementary TreeFig.1 shows Elementary Trees of LTAG wedened for Japanese.Figure 1: Example of Elementary TreesEach node is expressed by a predicate for-malism, in general, as following,For example, \ " is a self-contained(autonomous) word and its lexical item, com-prising an initial tree, is expressed by,Note that tense, aspect, polite expressions,\Ren-you (te)" are dealt with as inflectionsjust as in the classes teaching Japanese as Sec-ond Language.
The lexical items are classi-ed into several categories such as auto, link,prio, post, compo, according to the embed-ded tree structures.2.3 Tree OperationIn LTAG, 2 tree operations are dened(SeeFig.
2).
A node of a tree is said to be substi-tuted by another tree if the root node of thelatter is successfully unied with the node.A tree is said to be adjoined with anothertree if it is successfully inserted into the lat-ter by unifying the root node and the footnode(marked ) of the former, respectively,with the separated nodes of the latter, all witha same syntactic category.Figure 2: Examples of Substitution and Ad-junctionIn Japanese, a Yougen requires as ad-joined modiers Taigen phrases with connec-tives(e.g.
Fig.
2 (1)) corresponding to themandatory \ cases " ( e.g.
Fig.2 (2) ), and italso require have those corresponding to theoptional \cases".The default order of the case phrasesmay be changed for the purpose of stress-ing or avoiding unintended modication.
Thechange can be dealt with by way of permuta-tion in unication.Another type of phrase to modify theYougen is YP plus one of the connectives de-noting cause, reason-why, condition etc.
(e.g.Fig.3 (4)).A Yougen may be modied by a YP(Yougen Phrase) with its head Yougen in-flection in Ren-you form without any connec-tive(e.g.
Fig.3 (3)).A Taigen is mostly modied by a YP(Yougen Phrase) with its head Yougen in-flected in Rentai form with no connective(e.g.Fig.3 (2)).For ease and uniformity of processing, es-pecially in the diagnostic parser, null connec-tives -Ren-you and -Rentai are introducedwhen a YP modies Yougen and Taigen, re-spectively, by way of inflection(e.g.
Fig.3 (3),(2) ).The other type of phrase to modify theTaigen is TP plus connective \ (no)" de-noting proprietary, kinship or whole-part re-lationship(e.g.
Fig.3 (1)).2.4 Dealing with Situation - Depen-dent ExpressionBy incorporating into the feature structurean additional item expressing situational con-straints, the parser has the capability of diag-nosing usage of situation-dependent Japaneseexpressions such as giving and receiving ben-ets as well as demonstratives.
As for demon-stratives, e.g.
\ (kono-hon) ", \(sono-hon) ", \ (ano-hon) " indi-cates a book located either in the territory ofthe locuter, the listener, or outside the both,respectively.In the case of expression for giving and re-ceiving benets, for example as shown in Ta-Figure 3: Examples of Tree Structureble 1, the empathy relational constraints areembedded in each of the lexical items for theunderlined word along with the case informa-tion for \ (ga)", \ (ni)"Though the indicated three expressionshave the same propositional function of ex-pressing giving-benet whose giver is x andgivee is y, \camera" is placed on the side ofx, y, y with \angles" towards y, x, x respec-tively.
It is seen that the camera angle deter-mines the requirement to the empathy rela-tions(S.Kuno, 1989).Suppose the situation E(XjZ) < E(Y jZ) isgiven, where X, Y , Z stand for \the nurse",\the locutor?s son", \the locutor", respec-tively, for instance, the parser can diagnosethe following.English :\ The nurse(:X) reads the book to my son(:Y).
": I(:Z) am the locutor.Japanese : incorrect\ "(hobo-san ga watashi no musuko ni hon wo yonde-Table 1: Situational Constrains in LexiconExpressions Case Information Empathy constraintx y ( x ga y ni shite-ageru ) x , y E(xjz) > E(yjz)x y ( x ga y ni shite-kureru ) x , y E(xjz) < E(yjz)y x ( y ga x ni shite-morau ) y , x E(yjz) > E(xjz)locutor z : x give benet to yageru .
)Japanese : correct\ "(watashi no musuko ga hobo-san ni hon wo yonde-morau .
)2.5 Composite VerbsThe above-mentioned expressions for givingand receiving, e.g.
\ " yonde-morau , is an example of \composite verbs"in Japanese.Many composite verbs can be producedwith a considerable number of auxiliary verbspreceded by dierent main verbs.Because of the modication of the sense andthe case control due to the auxiliary compo-nent, as illustrated in the case informationcolumn in Table1, we are forced to generatethe composite tree (See Fig.4), carrying outmodication of the meaning and the case con-trol, before adjoining of modiers to the com-posite verb takes place.Figure 4: Examples of Composite Verb2.6 Modality Words and Illocution-ary - Act MarkersIn Japanese, \modality words"are func-tional words expressing the attitude of the lo-cutor towards the propositional part of the ut-terance, \illocutionary-act markers" demandsanswer from the listener or expresses other in-tention of the locution aecting the listener.Some combinations of certain adverbs anda \modality word" co-occur in the positioninterposing that part of the proposition inwhich the locutor has concern.
The exampleshown in Fig.5, \ "(darou) is a modal-ity word expressing locutor?s supposition, and\ "(osoraku) expresses the extent ofhis condence on the supposition.
The lexi-cal item for the latter includes the demand forthe modality semantics of the locutor?s sup-position.English : It will probably rain tomorrow, I?msure.Japanese :(ashita wa , osoraku ame ga huru darou yo.
)Figure 5: Modality Word and Illocutionary-Act Marker2.7 Connective \wa"In Japanese, TP plus connective \ "(wa)is frequently used.
It is said that there are twokinds of usage of connective \ " ; the one in-troduces the theme of the sentence, the otherdiscriminatorily presents one of the cases ofthe head Yougen as shown, respectively, inthe following cases.usage 1English : Me, I climbed that mountain.Japanese :(boku wa ano yama ni nobo-tta.
)usage 2English : (e.g.)
As for me, I?ll have adish of eel.Japanese :(boku wa unagi da.
)Figure 6: Example of the Usage of \wa"In distinguishing between usage1.
and us-age2., we focus on the head Yougen of YP.
If ithas any unlled-case, and the semantic con-straint of the Taigen before connective \" corresponds to that of one of the unlled-cases, then our processor regards \ " asdiscriminatory.Otherwise, \ " is considered as introduc-ing the theme of the sentence.2.8 Use of a Stack in ParsingFor implementing a parser for Japanese, astack memory can be conveniently employed.]
In processing the sentence from left to right,the candidate modier phrases are kept ina stack memory until a possible Yougen orTaigen word appears and inspected if theycan modify the word.
The tree-structuredfeatures of the candidate modier phrasespopped up one by one from the stack aretried to be unied with those of the word,and the features of the phrases as far as thetree adjoining unication succeeds are inte-grated with the features of the modied word,to make a Saturated Initial Tree(SIT).
Therest of the phrases of the stack are left thereto be tested on the next Yougen or Taigenword which will appear later on.
Any orderingof modiers is syntactically permitted exceptwhen an undesired modication takes place.\ If a connective is found by reading oneword ahead, the thus-far made SIT substi-tutes the left external node of the tree ofthe connective to make a Saturated AuxiliaryTree(SAT) provided unication succeeds(e.g.Fig.7).
If the read ahead is a modality word,its yp node is substituted by the yp root of theSIT, and after interposing modality modiershaving been processed, the resulting phrase isconsidered SIT anew and the procedure goesto \ .
If the read ahead is an illocutionary-actmarker or the ending sentence symbol, andthe inflection of SIT is appropriate, parsingterminates.
Otherwise either of the -Ren-you or -Rentai connectives is attached de-pending on the inflection of the head of theSIT to make a SAT ( See Fig.
3 and Fig.
7).In either cases as well as the case with a non-null connective, the SAT is pushed into thestack and the procedure recurs to ].Figure 7: Example of SAT and SIT3 GenerationWe describe here our algorithm for gener-ating a sentence when the semantic relation-Figure 8: Example of a Semantic Relationshipand Treesship, for example as in Fig8, is given.
Thegeneration process progresses as illustrated inFig9.The main stream of our generation algo-rithm follows.At rst, from the lexical database, an au-tonomous word is fetched, whose semantic re-lationship term is uniable with the root ofthe given semantic relationship.
Letting theroot and terminal node of the word be therst and the second arguments, respectively.generate2 is called If the rst argument can be unied withthe second argument, generation is termi-nated.
Otherwise, the process, carryingover the second argument, searches for aprio or link word whose root node canbe unied with the rst argument. If a prio word is found, letting its right (foot ) node be the rst argument and re-taining the second argument, generate2is called. If a link word is found, an autonomousword is searched for whose root node canbe unied with the left ( substitution) node of the link word.
Letting theword?s root and the terminal node be therst argument and the second argument,respectively, generate2 is called.
Let-ting the right ( foot ) node of the linkword be the rst argument and retain-ing the second argument, generate2 iscalled.In the following, searching of the au-tonomous word and handing their 2 nodes oto generate2 are dealt with by generate1predicates.generate1(Node):-auto(W,Node,Terminal),generate2(Node,Terminal).generate2(Node1,Node2):-unify(Node1,Node2).generate2(Root,Terminal):-prio(W,Root,Right),generate2(Right,Terminal).generate2(Root,Terminal):-link(W,Root,Left,Right),generate1(Left),generate2(Right,Terminal).In the case of generation including modalitywords, illocutionary-act markers or compositeverbs, the algorithm needs a little more com-plicated procedures.4 Case and Semantic Pro-cessing in Parsing andGenerationIn parsing and generation, case and seman-tic processing occurs by unication withoutany procedural programming.The initial tree structure of the lexical itemof an autonomous word consists of a root nodeand a terminal node.Especially in the YP initial tree, the rootnode has a lled used-case slot and a variableunused-case slot as well as a variable semanticslot whose head part is lled.
The terminalnode has the null used-case slot and the lledunused-case slot as well as the semantic slotconsisting only of the head predicate.Figure 9: Example of GenerationIn parsing, following the process as illus-trated in Fig.
9 bottom up, when the footYP node of a YP SAT ( e.g.)
is unied with the terminal node of aYougen autonomous word ( e.g. )
, thecase data, if any, ( e.g.
[Y,[ (Y)],]) corresponding to the SAT is moved fromthe unused-case slot to the used-case slot inthe SAT root node.
The semantic data fromthe SAT is integrated with that of the wordand transferred to the SAT root.
The footYP node of another YP SAT if any, ( e.g.)
is unied with the said root node thecorresponding case data, if any, ( e.g.
[Z,[(Z)], ]) is further moved from theunused-case slot to the used-case slot.The semantic data from the new SAT isjoined with that in the previous SAT root inthe root of the new SAT.Likewise proceeding, nally, by unifying theconcatenated SAT with the root of the origi-nal autonomous word ( e.g.
), there re-mains in the unused case slot those case dataswith no corresponding SAT which may be ex-plained by omitted SATs or the slash casewhose entity will be found in the Taigen wordto be modied by the thus-constructed mod-ifying YP.The whole semantic data from the SATs isintegrated in the root node of the original au-tonomous word.The process of adjoining TP SATs ( e.g.)
to modify a Taigen au-tonomous word ( e.g. )
is similar to thatfor YP SATs to a Yougen word, except thatno case data processing occurs.In generation, following the process as il-lustrated in Fig.
9 top-down, when the wholegiven semantic relationship is unied into thesemantic slot of a Yougen autonomous word( e.g.
), and if e.g.
a linkword ( e.g. )
is found with itsroot uniable with the root of the Yougeninitial tree, the semantic expression is di-vided into two parts thanks to the casedata ( e.g.
[Z,[ (Z)], ] ), the onepart ( e.g.
[ ( ,Z, , )]) is trans-ferred to the right node, and the other part( e.g.
[ (X,Z,Y),[ (Y),[(U,Y), ( ,U)]]] ) transferred tothe left ( foot ) node.
From the case dataof the used-case slot of the original yougen (e.g.
), the case data correspondingto the link word ( e.g. )
is moved fromthe used-case slot to the unused-case slot inthe left ( foot ) node.That part of semantics transferred to theright node is processed to nd the correspond-ing surface expression ( e.g. )
by con-structing an SIT.
The other part of seman-tics sent to the left ( foot ) node along withthe remaining used-case slot ( e.g.
[[Y,[(Y)], ]] ) are made use of for nding alink word ( e.g. )
whose root node isuniable with the said left ( foot ) node.The semantics sent to the new link rootnode is divided into two parts; the one part (e.g.
[ (Y),[ (U,Y), ( ,U)]])sent to the right node to form SIT and con-struct the corresponding surface expression (e.g.
), the other part (e.g.
[ (X,Z,Y)]) sent to the left ( foot) node.Likewise proceeding, when all the used-casedata is transferred into the unused-case slotin the foot node, it may be unied with theterminal node of the original yougen ( e.g.)
, terminating the generation.5 Mechanism of SemanticDiagnostic Processing5.1 PostulationIn our CALL system, the students are askedto ll in the blanks for composition in thegiven situation and context, using words froma given list.
Therefore no morphological anal-ysis is needed.
In diagnosing the students?sentence, we assume that the following datais available for constraining processing. Semantic elements and their relation-ships, which should be expressed by thesentence with which the students areasked to ll the blanks. The list of words, to be used in the com-position, corresponding to the semanticelements.Fig.10 is an example of relationships of se-mantic elements represented by a tree struc-ture.
Modifying elements are placed as thechildren of the parent, the modied elements.The list of the words to be used for expressingan element is linked to the element.Figure 10: Example of relationships of seman-tic elements5.2 Principle of Semantic DiagnosisAfter an SIT has been constructed, the di-agnostic parser consults the lexicon with thesucceeding word.
If it is a connective, theparser tries substitution operation with SITand, if successful, appends it to the SIT toform the temporary SAT.
In case the parserfails to append the connective to the SIT, onlythe surface expression of the connective alongwith the SIT is recorded in the provisionalSAT.
Suppose the succeeding word was nota connective.
If it was a Taigen or Yougenand the SIT is yp and its inflections is Rentaior Ren-you, respectively, then -Rentai or -Ren-you is appended to the SIT to form anSAT, even though the inflection might be in-correct.
If the inflection of the SIT is incon-sistent with the succeeding word or the SIT istp, as no reasonable interpretation is possible,\Pending Connective"  is appended tothe SIT to make an SAT.
In all of the above-mentioned cases, the obtained SAT is pushedinto the stack.
When the parser encountersa Yougen word[]] or a Taigen word, it popsup one SAT after another from the stack andexamines, locally generating surface expres-sions, if it conforms with one of the semanticchildren to the parent corresponding to thetarget Yougen/Taigen word.
If it does, theparser adjoins the SAT to the word, after, ifnecessary, having corrected wrong/missingconnective or wrong inflection of the SAT,thus making an SIT, including error correc-tion messages if any.
If the popped SAT doesnot conform with any of the semantic chil-dren, it is pushed into a temporary stack,recording the SAT as a false modier if SATcan be falsely adjoined to the Yougen/Taigenword.
In case of SAT accompanying , theparser, consulting the semantic relationshiptree data, generating a related phrase, eitherreplaces  with a suitable missing connec-tive and/or corrects the wrong inflection ifnecessary.
When an SAT is popped up whichconforms with one of the semantic children,the SATs held in temporary stack at that in-stance, if any, should have been obstaclesfor the popped up SAT to modify the targetword.
And they are marked \?".
After all theSATs in the main stack have been examined,the SATs recorded in the temporary stack arereturned into the main stack.
And then theSAT constructed as explained in the above ispushed into the main stack.
If, later on, theSATs marked \?"
are found to modify a tar-get word, conforming to the semantic relation-ship, they are commented as causing modi-cation crossover.
Finally, if the semanticrelationship requires modality expression(s)and/or illocutionary-act marker(s), the thus-far-made Yougen SIT is (recursively if neces-sary) substituted into the yp node of the ex-pression(s) and, at the same time, correspond-ing modiers of the expression(s) are lookedfor in the main stack to be popped making anSIT.If at []], the found Yougen word is a partof a composite verb the semantic relationshiprequires, the rest is looked for, supplementedif lacking, the case information is modied ifnecessary, and the same procedures follow asdescribed after []].6 Example of DiagnosisFor example, supposing the student had in-put the sentence shown in Fig.11, the parsercould detect the errors by using the seman-tic relationship aforementioned in Fig.10 andthe relation of the degrees of empathy in thegiven situation.The detected errors are listed in the follow-ing.Figure 11: Example of Result of Diagnosisfalse modication :Inappropriate placing \ "(watashino), causing the phrase to modify \"(hobo-san).missing connective :Missing connective \ "(ga) which \"(hobo-san) must have for thephrase to be adjoined to \"(yo-nde kureru).obstacle for modication :\ " (hobo-san) is in the place ofobstacle for \ "(watashi no) to mod-ify \ "(musuko).wrong inflection :\ "(yo-mi) has to be replaced by \"(yo-nde) for the verb to form acomposite verb together with auxiliaryverb \ "(kureru) expressing giv-ing benet.wrong connective :Wrong connective \ "(de) has to bereplaced by \ "(wo) which \ "(hon)must have for the phrase to be adjoinedto \ "(yo-nde kureru).modication crossover :The sentencehas a modication crossover between \"(watashi no musuko) and \"(hobo-san gayo-nde kureru).inappropriate situational expression :Use of \ "(ageru) in the given sit-uation designates empathy relationE(nursejlocutor)> E(the locutor0s sonjlocutor)which contradict with the given empa-thy relation.
It requires less numberof corrections for \ " to be re-placed by \ "(kureru) for conform-ing with the relation and retaining \"(musuko ni) than to be replaced by \"(morau).7 ConclusionsWe proposed a diagnostic processing ofJapanese and described its procedures in de-tail.
The parser makes use of LTAG formalismintroducing several additional data structuresuch as SIT, SAT, null/pending connectives.The diagnosis we reported here is local inprinciple.
Referring to the given relationshipof semantic elements, the error is detectedand corrected locally.
The correction mes-sages are generated and recorded locally inSITs.
The undesired modications in the stu-dent sentence, however, can be detected andcommented on.
Our CALL system, basedon the detected errors and inappropriateness,provides the students with sample texts whichwill enable the students to correct their sen-tence by themselves.The tasks to be achieved are:1. to establish ontology of semantic rela-tionship description,2.
ecient methodology for preparing thelexical items comprising semantic con-straints,3.
to communicate semantic contexts andsituations to the students through assist-ing reading the texts by way of bidirec-tionally linking the text words with anelectronic dictionary,4.
to deal with anaphora.AcknowledgmentThe authors are grateful to Prof. Jun-ichiTsujii, University of Tokyo, for discussing andproviding information on LTAG as well as thestatus quo of natural language processing.The work reported in this paper was par-tially supported by the Grant-in-Aid for Sci-entic Research 09680303, Ministry of Educa-tion.ReferencesThe XTAG Research Group ( 1995 ) : \ A Lexi-calized Tree Adjoining Grammar for English", University of Pennsylvania, IRCS Report95-03, March 1995.Owen Rambow and Aravind K. Joshi ( 1994 ): \ A Processing Model for Free Word Or-der Languages ", In Perspectives on Sen-tence Processing, C.Clifton, Jr.,L.Frazier andK.Rayner, editors.
Lawrence Erlbaum Asso-ciates.Carl Pollard, Ivan A.
Sag ( 1994 ) : \ Head-Driven Phrase Structure Grammar ", TheUniversity of Chicago Press.M.Nagao ( 1996 ) : \ Natural Language Process-ing ",Iwanami-Shoten.V.
M. Holland, J. D. Kaplan, M. R. Sams ( 1995): \ Intelligent Language Tutors { TheoryShaping Technology { ", LEA,pp.183-200 .T.
M. Duy, J. Lowyck, D. H. Jonassen ( 1991) : \ Designing Environment for Construc-tive Learning ", NATO ASI Senes Vol.F105,Springer-Verlag.H.
G. Widdowson ( 1977 ) : \ Teaching Lan-guage as Communication ", Oxford Univer-sity Press.Susumu Kuno ( 1989 ) : \Danwa - no - Bunpou(Grammar of Discours )", Daisyukan-Syoten.Nobutaka Kato, Yi Liu, Tomonori Manome,Hisayuki Kanda, Makoto Itami, Kohji Itoh( 1997 ) : \ Use of Situation-Functional In-dices for Diagnosis and Dialogue DatabaseRetrieval in a Learning Environment forJapanese as Second Language ", Proceedingsof AIED ?97, pp.247-254.

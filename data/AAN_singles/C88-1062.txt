VOCNETS - A TOOL FOR HANDLING F INITE VOCABULARIESHans KARLGRENKVAL Ins t i tu te  for In format ion  Sc ienceSSdermalms torg 8S- l l6 45 S tockho lmSwedenJ~rgen KUNZEAcademy of Sc iences  of the GDRPrenz lauer  P romenade 149-152Berl in,  DDR - 1100German Democrat ic  Repub l i cAbst rac tA method  is p roposed  for s tor ing  af in i te  vocabu lary  in a manner  wh ich  makes itconven ient  to recogn ize  words  and subst r ingsof words.
The representat ion ,  wh ich  can begenerated  automat ica l ly  from a l ist of wordsor f rom g iven representat ions  of other  setsby means  of which  the vocabu lary  has beende f ined  through set or s t r ing  operat ions ,  hasthe form of a mod i f ied  f in i te -s ta te  grammar,a form e l iminat ing  the mul t ip l i ca t ive  e f fectsof con junct ion ,  complementat ion ,  etc.,  on thenode sets of convent iona l  f in i te -s ta terepresentat ions .0.
BackgroundTrad i t iona l ly ,  l ingu is ts  descr ibe  sent-ences,  and in f lec ted  and der ived  word  formsby means of rules, whereas  vocabu lar ies  areaccounted  for by enumerat ion .
But even forthe purpose  of spec i fy ing  a g iven lex icon orthe vocabu lary  of a g iven p iece of text  wef ind mere enumerat ions  inconven ient  to accessand not very  i l luminat ing.
We want  answersto be read i ly  g iven to quest ions  l ike whethera g iven s t r ing  is a member  (or a pref ix ,  asuff ix,  some other  subst r ing  or sequence ofsubst r ings  of a member) ,  ~or wh ich  e lements  ofsome set of s t r ings  have such propert ies .That is, we want  to ar range the lex ica l  dataso that it is easy  to per form Boo lean  ands t r ing  operat ions  on sets of words.We there fore  in t roduce  a grammar- l i kerepresentat ion  for a f in i te  vocabu lary ,spec i fy ing  it as is, i.e.
, w i thoutexaggerat ion  or omiss ion,  w i th  no c la im onthe l ingu is t i c  s tatus  of the set descr ibed  orthe ru les const ructed  to spec i fy  it.
Nopred ic t ion  about potent ia l  s t r ings  outs idethe g iven set is suggested.
Therepresentat ion  can be a lgor i thmica l ly  der ivedfrom a l ist  of the words  in the vocabu lary .The proposed  too\]  appears  to havetheoret i ca l  as we\ ] \ ]  as computat iona l  mer i ts .1.
TaskWe thus requ i re  a method  for repre-sent ing  a v o c a b u 1 a r y V of s t r ingsover  on a 1 p h a b e t A (of letters,phonemes,  morphemes  or other  atoms), where* A is smal l  compared  to the vocabu lary  V(say, 30 aga inst  30 000 or 300 000),* the vocabu lary  V, though large, is f inite,* V has a "structure"  in the sense that,typ ica l ly ,  a s t r ing  in V conta ins  subst r ingsinc luded  in other  s t r ings  in V.We want  the representat ion  to* permit  conven ient  r e t r i e v a 1 ofs t r ings  and subst r ings  of st r ings in V,* be a lgor i thmica l ly  const ructed  on s u c-c e s s i v e i n p u t of s t r ings  in V,or, if V is de f ined  through B o o 1 e a n ors t r i n g o p e r a t i o n s on othersets, be der ivab le  from operat ions  on repre-sentat ions  of these more e lementary  sets,* be reasonab ly  c o m p a c t for pract ica lcomputat iona l  app l icat ions .2.
Mod i f ied  F in i te -S ta te  Representat ionWe have chosen to represent  vocabu lar iesas mod i f ied  f in i te -s ta te  gra~aars,  wh ich  weshal l  cal l  vocnets.A vocnet  wi l l  inc lude a f inite d i rec tedgraph w i th  edges, a r r o w s, l abe l led  w i the lements  of the a lphabet  A.
Such a graphwi l l  spec i fy  a vocabu lary  over  the a lphabet  Aif we mark  a subset  S of the nodes as sourcenodes and def ine  as an accepted  word theconcatenat ion  of the labels  of such pathsth rough the graph from nodes in S as arr iveunder  cer ta in  side cond i t ions  at a set ofnodes wh ich  fu l f i l l s  g iven target  cond i t ions .We do not assume a vocnet  to bedetermin is t i c  in the sense that for any nodei and s t r ing  ~ there exist  on ly  one node jsuch that ~ is a path  from i to j. Shou ldwe in t roduce  such a res t ra in t ,  it can beproven  that  it is lost a l ready  under  regu laroperat ions  on the vocabu lar ies ,  ioe., thatthis a t t rac t ive  feature wi l l  be absent  from avocnet  der ived  in the manner  we propose  forthe union, concatenat ion  set or closure ofthe vocabu lar ies ,  for wh ich  determin is t i cvocnets  had been introduced.P recaut ions  had to be taken to keep themechan ica l ly  generated  representat ionscompact .
In par t icu lar ,  it was essent ia l  toe l im inate  the we l l -known mul t ip l i ca t ivee f fect  on the number  of states a r i s ing  whens tandard  f in i te -s ta te  grammars  are combinedby in tersect ion  and complementat ion .3.
Def in i t ion  of vocnet  graphsA vocnet  graph U = <A, N, C', C">quadrup le ,  whereis aA is an a lphabet  of a t o m s a, b; c, ...N is a set of n o d e s h, i, j, k, .o.C' and C" are mapp ings  of A into N ~N.We def ine  C(x) = C'(x) u C"(x) as theset of c a t e g o r i e s of "the atom x.We def ine  ti le product  C 4 o C~ of twocategory  sets C~ and C~ asC~ o C~ ={(i, j ) IBk (i, k )e  C~^(k~ j) ?
C~Iand the category  set for a s t r ing  ~ : x ~ asc(~)  = C(x) o c (~)We shal l  say that the atom x C o n-n e c t s the set M1 to the set M2 in U iffe i ther  M2 is the set of al l  j for wh ich  thereis a node i in MI such that (i, j )~ C'(x)ror M2 is the set of all j for wh ich  there isa node i in M1 such that (i, j )~  C"(x).306We shal l  a \ ]so say that a s t r ing  & = xconnects  Ml to M2 if there is some set M3such that x connects  M1 to M3 and ~ connectsM3 to M2?By :introducing two kinds of arrows,  onecan so to speak synchron ize  para l le l  paths:the res t ra in t  that  in every  path the ar rowassoc ia ted  w i th  one pos i t ion  in a s t r ingwi l l  haw!
to be of the same kind can beu t i l i zed  to par t i t ion  the graph into zoneswh ich  cor respond to segments  of the str ings,if one k ind of arrows,  i n t r a z o n earrows (tliose in C') join nodes w i th in  thesame zone and another  kind, i n t e r-z o n e arrows (those in C")~ join nodes inone zone w i th  nodes in another  zone.
As t r ing  can then be seen as cons is t ing  ofsegments  separated  by junctures,  where  eachsegment  J s assoc ia ted  wi th  para l le l  in t razonear row sequences  and each juncture  wi thpara l le l  in terzone arrows.4?
Def in i t ion  of VocnetsA vocnet  G is a t r ip le  <U, S, P>~ whereS ~N is a non-empty  set of s o u r c enodesP(M) is ~t t a r g e t c o n d i t i o n onnode sets M, P(M) be ing  a propos i t ion  overe lementary  cond i t ions  of the form that Mover laps  w i th  some subset  E of N, say(M~E\ ]  ~: ~)A  ~(MoE~>2 ?
~).The sets E1 and E2 here form thet a r g e t a r e a s of G.The un ion of al l  min imal  sets M forwh ich  P(M) is true in the vocnet  G wi l l  beca l led  the t a r g e t s e t T of G.A vocnet  G def ines  the language L(G):\[ (* I ~M ~N and ~ connects  S to thenon-empty  node set M and P(M) is true\]Whereas  for a s t r ing  to be accepted  by aconvent iona l  f in i te -s ta te  grammar it isenough ~hat it is assoc ia ted  wi th  onepermi t ted  path through the graph, a s t r ingwi l l  be accepted  by a vocnet  if it isassoc ia ted  w i th  a set of s imu l taneous  paths,each lead ing from a source  node to a targetnode, these target  nodes forming a permi t tedcombinat ion  M (i.e., M is not empty  and P(M)i.S true).The vocnet  may conta in  spec ia l  e x i tc h e c k e r s. An exit  checker  is a dummyzone, cons is t ing  of exact ly  one nodeconnected  to i tse l f  by an ar row in C' foreach atom in A.
By us ing ex i t  checkers ,local  cond i t ions  for zones can be accountedfor in the target  cond i t ions  for the who levocnet?
The exit  checkers ,  in a way, wi l lthen fre~,ze the zone exit  cond i t ions  so thatthey remain  access ib le  for ver i f i ca t ion  whenthe who le  graph has been passed through.5.
Genexat ion  of Vecnets  from List  of WordsA vocnet  for a g iven vocabu lary  can begenerateo  a lgor i thmica l ly  in the fo l low ingmanner?Words  are entered  one by one.
For eachnew word  un ique new nodes are introduced:  ifthe new word is x^xz.. ,  x~ , each let ter  x~is g iven  the new category  (kT  ,k~+A), whereno k~.
ex is ted  before.C lear ly ,  this p rocedure  wi l l  c reate  avocnet  wh ich  wi l l  account  for all and on lythe words  given?
The set of nodes, however,wi l l  typ ica l ly  be much larger  than necessary,but it can be reduced  - a f ter  one word  hasbeen entered  or af ter  the inser t ion  ofsevera l  words  - by appropr ia te  fus ion ofnodes; cf.
sect ion  8 infra.6.
Set Operat ions  on Vocabu lar iesIn the :following, it wi l l  be assumedthat the vocabu lar ies  cons idered  are st r ingsover  the same a lphabet  A, that none of theminc ludes  the empty  str ing, and that thevocnet  graphs  wh ich  we combine  have d i s junctsets of nodes.6.1 Complement  Format ionG iven  a vocnet  G1 for a language LI, thevocnet  G for the complement  L is g ivenimmediate ly  by rep lac ing  P1 by its negat ionG = < UI, SI, ~ PI>,Jf G1 is complete  in the sense that for anyst r ing there  ex ists  some path beg inn ing  in ane lement  of SI.
If G1 is not complete  in thissense, it can be made complete  at the expenseof add ing  one more node.6.2 Un ionIn a vocnet  G = <U, S, P> for the un ionof L(GI) and L(G2) the vocnet  graph U isformed d i rec t ly  through union of the e lementsof U1 and U2, and P is formed throughd is junct ion :U = <A, N1 uN2,  C I '~ C2', C l "u  C2">S = SI u $2P(M) <:> PI(M) v P2(M) for M ~ N.6.3 In tersect ionIn a vocnet  G for L(GI) ~ L(G2),  U and Sare formed as in the case of un ion andP(M) <=> Pl(M) A P2(M) for S ~ N.Thus, one and the same vocnet  graph wi l lserve as a component  in vocnets  de f in ingd i f fe rent  languages.7.
S t r ing  Operat ions  on Vocabu lar ies7.1 Concatenat ionThe concatenat ion  set V of V1 and V2,i.e., the set V of st r ings cons is t ing  of as t r ing in Vl, spec i f ied  by the vocnet  GI,concatenated  wi th  one in V2, spec i f ied  by thevocnet  G2, is de f ined  by a vocnet  GG = <U, SI, P>whereU = <A, NI+uN2, C I 'u  C2', C l "+u C2"u  C12">P(M) <=> QI(M) A P2(M)HereNI+ is N1 w i th  the add i t ion  of exit  checkers:if G1 has the target  areas El, ?
'2,..., NI+wi l l  conta in  the exit  checkers  fl, f2, ...,C I"+ is CI" w i th  the add i t ion  of arrows foreach atom from each node in Ep to the exitchecker  fp,CI2"(x)  is tile set of all ar rows (i, j) w i thi ~ T1 and j 6 N2 for wh ich  (h, j) ~ Cl '(x) forsome h & $2.QI(M) is the f rozen vers ion  of PI(M),  w i thfl, f2, ..., subst i tu t ing  El, E2, ...The vocnet  graphs U1 and U2 have thusbeen in tegrated  as zones into the new vocnetgraph.
A few exit  checkers  have been  added307to permit  express ing  the res t ra in ts  on thepass@ge through the zone U1 as targetcond i t ions  on the to ta l i ty  of G. Thanks tothe use of exit  checkers  the complex i ty  ofthe target  cond i t ion  P of G in terms of thenumber  of target  areas is not the product  ofthe complex i t ies  of Pl and P2 but less thanthe i r  sum.7.2.
Rest r i c ted  I terat ion  and Invo lu t ionThe languages  L(GI) u L(GI )Zu.
.
.
u L(GI) qand L(GI)q (q = ~ 2) may be represented  asvocnets  that are const ructed  in a s imi la r  wayas for concatenat ion ,  w i th  GI in the role ofG2, but the exit  checkers  have to bes t ra t i f i ed  so that we may count the depth  dof the concatenat ion .
There fore  C"(x)conta ins  bes ides  the categor ies  exp la ined  in7.1 all  pairs  (dfp, d*~fp) for l~d  ~q- l .The target  cond i t ion  for res t r i c tedi te ra t ion  isP(M) <:> PI(M) A (Mn\ [q f l ,q f2  .... \] = ~) A( q-A PI(M) => ... => 4PI(M))and for the p- th power  of L(GI)P(M) <=> PI(M) A (Mr \ [q f \ ] ,q f2  .... \] = ~) A~'API(M) A ... A ~PI(M).Here, ~ PI(M) are the f rozen s t ra t i f i edtarget  cond i t ions  of GI.7.3.
Decatenat ionG iven  one vocnet  G1 (say for wordsbeg inn ing  wi th  a pref ix)  and another  vocnetG2 (say for p re f ixes  and pref ix  sequences) ,we search  a vocnet  G (say for words  s t r ippedof the i r  pref ixes)  such that ~& L(G\] iff~4a~A2 ( ~ & L(GI) A 0~2C-L(G2)AThe fo l low ing  vocnet  G wi l l  sa ts i fy  ourrequ i rement  :G = <UI, S, PI>where  S is the un ion of al l  sets M ~NI  forwh ich  S1 is connected  to M in G1 by somes t r ing  conta ined  in L(G2).8.
Equatab i l i ty  and Node Fus ionVocnets  generated  wi th  the incrementa la lgor i thm descr ibed  in sect ion  5 abovetyp ica l ly  conta in  more  nodes than a min ima lvocnet  for the same language.
S imi lar ly ,vocnets  der ived  from other  vocnets  tend to beh igh ly  redundant .Compact ing  of a g iven vocnet  can bea lgor i thmica l ly  per fo rmed as fol lows.We shal l  say that nodes in a vocnet  Gare e q u a t a b 1 e if they can beident i f ied  w i thout  a f fec t ing  the languagedef ined  by G.The fo l low ing  de f in i t ions  permi t  us tof ind pai rs  of equatab le  nodes.We f i rst  de f ine  some equ iva lencere la t ions  between nodes.The nodes i and j are p r e c e-d e n c e e q u i v a 1 e n t in a vocnetgraph U iff for all k and x(k, i )~  C'(x) <=> (k,and(k, i) G C"(x) <=> (k,j) ~ C'(x)j) 6 C-(x)The nodes J and j ares i o n e q u i v a 1 e n tgraph U iff for all k and xs U C C e s-in a vocnet(i, k) e C' (x) <=> (j~ k) 6 C' (x)and(i, k) ~C"(x )  <=> (j, k )eC ' (x )The nodes i and j are s o u r c ee q u i v a 1 e n t in a vocnet  G iffi&S  <=> j&SThe nodes i and j are t a r g e te q u i v a 1 e n t in a vocnet  G iff forany subset  M of NP(M u {i}) <:> P(M u \[ j}).Now tile nodes i and j are 1 e f te q u i v a 1 e n t in a vocnet  G iff theyare precedence  and source equiva lent ,  rPheyare r i g h t e q u i v a 1 e n t in avocnet  G iff they are success ion  and targetequ iva lent .
They are e q u a t a b I e if -but not necessar i l y  on ly  if - they are leftor r ight  equiva lent .By success ive  fus ion of pa i rw iseequatab le  nodes vocnets  can be - not rare lyd ras t i ca l l y  - compacted.
It should  be noted vhowever,  that equatab i l i ty  is not anequ iva lence  re la t ion  and that reduct ion  of ag iven vocnet  graph does not y ie ld  a un iqueresu l t  but depends on the cho ice  of nodepairs  to ident i fy  in each step of theprocedure .9.
Paras i tesBy p a r a s i t e s of a language Lwe shal l  mean str ings wh ich  are not membersof L nor subst r ings  of members  of L.C lear ly ,  if w i th  the vocnet  G t i le  setC (~ ) is empty, ~ is a paras i te  of L(G)~ 4,is not a member  nor wi l l  it become a memberwhatever  is appended at e i ther  end.We shal l  say a node i in a vocnet  G isg e n u i n e if there is some st r ing  o<assoc ia ted  w i th  a path from a source node inG v ia  i to a node in some M, such thatconnects  S to M and P(M) is true.If al l  nodes in a notvec are genu ine  r as t r ing  4. is a paras i te  iff C(o< ) is empty.The vocnet  wi l l  then of fer  us an assoc ia t iveca lcu lus  for recogn iz ing  paras i tes  (ands t r ings  wh ich  const i tu te  the beg inn ing  of aword  or the end of a word).A node i is ingenu ine  if no path leadsfrom nodes in S to i or from i to nodes of ToIf P(M) has the s imple  form that M mustover lap  w i th  some g iven target  set, a node iis ingenu ine  on ly  if the preced ing  cond i t ionis fu l l f i l led.i0.
Node E l iminat ionIngenu ine  nodes can be removed from thegraph U w i thout  a f fec t ing  the languageaccepted  by G = <U, S, P>.Success ive  e l im inat ion  of ingenu inenodes and fus ion of equatab le  node may leadto cons iderab le  compress ion  and s impl i -f i ca t ion  of a given vocnet.
It should  beobserved  that the final, i r reduc ib le  resu l tof such compress ion  is not independent  of thecho ice  at each stage of what  reduct ionoperat ion  to perform.308

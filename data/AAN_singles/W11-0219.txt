Proceedings of the 2011 Workshop on Biomedical Natural Language Processing, ACL-HLT 2011, pages 146?154,Portland, Oregon, USA, June 23-24, 2011. c?2011 Association for Computational LinguisticsBuilding Timelines from Narrative Clinical Records: Initial ResultsBased-on Deep Natural Language UnderstandingHyuckchul Jung, James Allen, Nate Blaylock, Will de Beaumont,Lucian Galescu, Mary SwiftFlorida Institute for Human and Machine Cognition40 South Alcaniz Street, Pensacola, Florida, USA{hjung,blaylock,jallen,wbeaumont,lgalescu,mswift}@ihmc.usAbstractWe present an end-to-end system that proc-esses narrative clinical records, constructstimelines for the medical histories of pa-tients, and visualizes the results.
This workis motivated by real clinical records andour general approach is based on deep se-mantic natural language understanding.1 IntroductionIt is critical for physicians and other healthcareproviders to have complete and accurate knowl-edge of the medical history of patients that  in-cludes disease/symptom progression over time andrelated tests/treatments in chronological order.While various types of clinical records (e.g., dis-charge summaries, consultation notes, etc.)
containcomprehensive medical history information, it  canbe often challenging and time-consuming to com-prehend the medical history of patients when theinformation is stored in multiple documents in dif-ferent  formats and the relations among variouspieces of information is not explicit.For decades, researchers have investigated tem-poral information extraction and reasoning in themedical domain (Zhou and Hripcsak, 2007).
How-ever, information extraction in the medical domaintypically relies on shallow NLP techniques (e.g.,pattern matching, chunking, templates, etc.
),  andmost temporal reasoning techniques are based onstructured data with temporal tags (Augusto, 2005;Stacey and McGregor, 2007).In this paper, we present our work on develop-ing an end-to-end system that  (i) extracts interest-ing medical concepts (e.g., medical conditions/tests/treatments), related events and temporal ex-pressions from raw clinical text records, (ii) con-structs timelines of the extracted information; and(iii) visualizes the timelines, all using deep seman-tic natural language understanding (NLU).Our deep NLU system extracts rich semanticinformation from narrative text records and buildslogical forms that  contain ontology types as well aslinguistic features.
Ontology- and pattern-basedextraction rules are used on the logical forms toretrieve time points/intervals, medical concepts/events and their temporal/causal relations that arepieced together by our system?s temporal reasoningcomponent to create comprehensive timelines.Our system is an extension to a well-provengeneral-purpose NLP system (Allen et  al., 2000)rather than a system specialized to the clinical do-main, and the temporal reasoning in our system istightly integrated into the NLP system?s deep se-mantic analysis.
We believe this approach will al-low us to process a broader variety of documentsand complex forms of temporal expressions.In the coming sections, we first present a moti-vating example, a real clinical record of a cancerpatient.
Next, we give an overview of our NLUsystem including how medical ontology is inte-grated into our system.
The overview section isfollowed by detailed description of our informationextraction and temporal reasoning approach.
Then,we discuss our results and conclude.2 Motivating ExampleOur work is carried out as a collaboration with theMoffitt  Cancer Center (part of the NCI Compre-hensive Cancer Centers), who have provided uswith access to clinical records for over 1500 pa-tients.
Figure 1 shows a (de-identified) ?History ofPresent Illness?
(HPI) section of a Thoracic Con-sultation Note from this data set.146The text of this section provides a very detaileddescription of what  problems/tests/treatments ananonymous cancer patient went  through over a pe-riod.
Such narrative text is common in clinicalnotes and, because such notes are carefully createdby physicians, they tend to have only relevant in-formation about patient medical history.Nonetheless, there are lots of challenges in con-structing complete and accurate medical historybecause of complex temporal expressions/relations, medical language specific grammar/jargons, implicit  information and domain-specificmedical knowledge (Zhou and Hripcsak, 2007).In this paper, as an initial step towards con-structing complete timelines from narrative text,we focus on sentences with explicit  temporal ex-pressions listed below (tagged as Line 1 ~ 11) plusa sentence in the present tense (Line 12):1?Line 1: She had a left radical nephrectomy in  09/2007; pathological stage at that time  was a T3NX MX.
?Line 2: Prior to her surgery CT scan in 08/2007showed lung nodules.
?Line 3: She was placed on Nexavar in 11/2007.
?Line 4: She was started on Afinitor on 03/05/08.
?Line 5: She states that prior to starting the Afini-tor she had no shortness of breath or dyspnea onexertion and she was quite active.
?Line 6: Unfortunately 4 weeks after starting theAfinitor she developed a dry cough and progres-sive shortness of breath with dyspnea on exer-tion.
?Line 7: She received a 5 day dose pack ofprednisone and was treated with Augmentin in05/2008.
?Line 8: She subsequently had a CT scan of thechest  done on 05/14/08 that  showed interval de-velopment of bilateral lower lobe infiltrates thatwere not present on the 02/19/08 scan.
?Line 9: Because of her respiratory symptoms, theAfinitor was stopped on 05/18/2008.
?Line 10: Prior to  the Afinitor she was able towalk, do gardening, and swim without anyshortness of breath.
?Line 11: She has had a 140 pound weight  since10/2007.
?Line 12: She denies fevers, chills, hemoptysis orchest pain.In these 12 sentences, there are instances of 10treatments (e.g., procedures such as ?nephrectomy?and drugs such as ?Nexavar?
), 3 tests (e.g., CT-scan), 13 problems/symptoms (e.g., lung nodules)and 2 other types of clinical findings (e.g., the can-cer stage level ?T3 NX MX?).
There are also 23events of various types represented with verbs suchas  ?had?, ?was?, ?showed?, and ?was started?.While there are simple expressions such as ?on03/05/08?
in Line 3, there are also temporal ex-pressions in more complex forms with time rela-tions (e.g., ?prior to?
), time references (e.g., ?atthat time?)
or event references (e.g., ?4 weeks afterstarting Afinitor?).
Throughout  this paper, we willuse Line 1 ~ 12 as a concrete example based onwhich we develop general techniques to constructtimelines.1For privacy, identities of patients/physicians were concealed and the dates/time-spans in the original sources werealtered while maintaining their chronological order.
Some measurements and geographic names were also modified.Figure 1: A sample medical record -- ThoracicConsultation Note1PAST MEDICAL HISTORY:1.
History of melanoma of the left arm.
She had excision of 3 sentinel lymph nodes in the left axillathat were negative.
This was in 07/2007.2.
Status post right hip replacement.3.
Status post cholecystectomy.4.
Status post renal stone removal.5.
Fracture of the right hip and left wrist in a motor vehicle accident.6.
Diabetes.7.
Elevated cholesterol.8.
Hypertension.9.
Spinal stenosis.ALLERGIES:She has no known drug allergies.
She is allergic to IVP dye which causes shortness of breath.
Shetolerates IV dye when she is pre treated.SOCIAL HISTORY:She is born and raised in California and she lived in Florida for 30 years.
She has worked as amedical billing analyst.
She has never smoked.
She does not use alcoholic beverages.FAMILY HISTORY:Her father died at age 69 of prostate cancer.
Her mother died at age 72 of emphysema.
She had 1sister who died from melanoma.REVIEW OF SYSTEMS:A complete review of systems was performed.
See the questionnaire.
She has hypothyroidism.She has some back pain related to her spinal stenosis.
She suffers from mild depression.CURRENT MEDICATIONS:1.
Carvedilol 6.25 mg p.o.
daily.2.
Darvocet N100, 1 tablet as needed.3.
Fish oil, 1000 mg three times a day.4.
Glimepiride 4 mg daily in the morning and 2 mg at bedtime.5.
Lipitor 20 mg daily.6.
Metformin 1000 mg twice daily.7.
Paroxetine 20 mg daily.8.
Synthroid 0.112 mg daily.9.
Tylenol as needed.10.
Vitamin B12, 2500 mcg p.o.
twice daily.XXX X XX-XX-XXCONSULTATION DATE: 07/06/2008RE: XXX BIRTH DATE: XX/XX/XXXXUR#: XX-XX-XX AGE: 75THORACIC CONSULTATION NOTEREQUESTING PHYSICIAN:XXXXXXXXXX, MD.REASON FOR CONSULTATION:Shortness of breath and abnormal chest x ray.HISTORY OF PRESENT ILLNESS:Ms. XXX is a 75 year old woman who has a history of metastatic renal cancer.
She had a left radicalnephrectomy in 09/2007; pathological stage at that time was a T3 NX MX.
Prior to her surgery CTscan in 08/2007 showed lung nodules.
These nodules have progressed with time.
She was placedon Nexavar in 11/2007.
She subsequently was found to have a new mass in her left nephrectomybed.
She was continued on the Nexavar, however, she showed radiographic progression and theNexavar was discontinued.
She was started on Afinitor on 03/05/08.
She states that prior to startingthe Afinitor she had no shortness of breath or dyspnea on exertion and she was quite active.Unfortunately 4 weeks after starting the Afinitor she developed a dry cough and progressiveshortness of breath with dyspnea on exertion.
She received a 5 day dose pack of prednisone andwas treated with Augmentin in 05/2008.
This had no impact on her cough or shortness of breath.She subsequently had a CT scan of the chest done on 05/14/08 that showed interval developmentof bilateral lower lobe infiltrates that were not present on the 02/19/08 scan.
She had mediastinaland right hilar adenopathy that had increased.
She had multiple lung nodules and there wasrecurrent tumor noted in the left renal bed which was thought to be larger.
Because of herrespiratory symptoms, the Afinitor was stopped on 05/18/08.
She still has a dry cough.
She is shortof breath after walking 15 to 20 feet.
She has no shortness of breath at rest.
She denies PND ororthopnea.
Prior to the Afinitor she was able to walk, do gardening, and swim without any shortnessof breath.
She has had a 140 pound weight since 10/2007.
She notices anorexia.
She has notravel history.She denies fevers, chills, hemoptysis or chest pain.
She has never smoked.
She deniespneumonia, asthma, wheezing, or myocardial infarction, congestion heart failure or heart murmur.She has dogs and cats at home and has had them for a long time and this never caused herrespiratory problems.PHYSICAL EXAMINATION:VITAL SIGNS:   Blood pressure 131/74, pulse 106, respiratory rate 20, temperature 97.3, weight64.0 kg.HEENT:   Pupils equal, round, reactive to light.
Extraocular muscles were intact.
Nose and mouthwere clear.NECK:  Trachea midline.
Carotids were 2 plus.
No masses, thyromegaly or adenopathy.LUNGS:   Respirations were unlabored.
There is no dullness to percussion or tenderness topalpation.
She has some bibasilar dry rales.HEART:   Regular rate and rhythm without murmur.ABDOMEN:  Soft, positive bowel sounds, nontender.EXTREMITIES:   No clubbing or cyanosis.
She had some mild pedal edema.DATABASE:Chest x ray from 06/01/08 was reviewed.
She had bilateral lower lobe patchy densities.
She hadsome nodular densities bilaterally as well.
There is widening of the mediastinum on the right.
CTscan of the chest from 05/14/08 also was reviewed.
She had bilateral lower lobe infiltrates that werenew.
She had mediastinal and right hilar adenopathy.
She had multiple lung nodules.
There isrecurrent tumor in the left renal bed that was thought to be larger.IMPRESSION:1.
Metastatic renal cancer with multiple lung nodules with mediastinal and hilar adenopathy.2.
Bilateral lower lobe infiltrates.
These infiltrates had developed after starting the Afinitor, as didher shortness of breath and dyspnea on exertion.
She recently started on oxygen by her primarycare physician when she was found to have exercise O2 saturations of 86%.
She is currently taking2 liters of oxygen.
I would be concerned that the infiltrates may be related to pneumonitis from theAfinitor.
I also think her shortness of breath, cough and hypoxemia are related to the infiltrates aswell.RECOMMENDATIONS:1.
I reviewed my impressions with the patient.2.
I am going to schedule her for a bronchoscopy and bronchoalveolar lavage.
I am going to getbaseline pulmonary function tests on her.3.
She will be seen by Dr. XXX on 08/12/08.
I will call and discuss the case with him pending theabove results.
The options are likely going to be observation off Afinitor or may consider placing heron prednisone, if the bronchoalveolar lavage is unremarkable.4.
Further recommendations will be made after the above.Do not type or edit below this line.
This will cause format damage.Dictated by XXXX, MDElectronically SignedFXXXXXXX, MD 07/10/2008 10:15________________________XXXXX, MDDD: 07/10/2008  9:24 ADT: 07/13/2008 11:46 AID: XXXXXXX.LMLCS: XXXXXXcc:?
?HISTORY OF PRESENT ILLNESS:Ms. XXX is a 75 year ld woman who has a history of metastatic renalcancer.
She had a left adi al nephrectomy in 09/2007; pathological stageat that time was a T3 NX MX.
Prior to her surgery CT scan in 08/2007showed lung nodules.
These nodules have progressed with time.
She wasplaced on Nexavar in 11/2007.
She subsequently was found to have anew mass in her left nephrectomy bed.
She was continued on theN xavar, owever, she showed radiographic progression and the Nexavarwas disc ntinued.
She was started on Afinitor on 03/05/08.
She statesthat p i r to starting the Afinitor she had no shortness of breath ordys n a on exe tion and she was quite active.
Unfortunately 4 weeksafter starting the Afinitor she developed a dry cough and progressivetness f br th with dyspnea on exertion.
She received a 5 day dosepack of prednisone and was treated with Augmentin in 05/2008.
This hadno impact on her cough or shortness of breath.
She subsequently had aCT scan of the chest done on 05/14/08 that showed interval developmentof bilateral lower lobe infiltrates that were not present on the 02/19/08scan.
She had mediastinal and right hilar adenopathy that had increased.She had multiple lung nodules and there was recurrent tumor noted in theleft renal bed which was thought to be larger.
Because of her respiratorysymptoms, the Afinitor was stopped on 05/18/2008.
She still has a drycough.
She is short of breath after walking 15 to 20 feet.
She has noshortness of breath at rest.
She denies PND or orthopnea.
Prior to theAfinitor she was able to walk, do gardening, and swim without anyshortness of breath.
She has had a 140 pound weight since 10/2007.
Shenotices anorexia.
She has no travel history.
She denies fevers, chills,hemoptysis or chest pain.
She has never smoked.
She denies pneumonia,asthma, wheezing, or myocardial infarction, congestion heart failure orheart murmur.
She has dogs and cats at home and has had them for a longtime and this never caused her respiratory problems.1473 Natural Language Understanding(NLU) SystemOur system is an extension to an existing NLU sys-tem that is the result of a decade-long research ef-fort  in developing generic natural language tech-nology.
The system uses a ?deep?
understandingapproach, attempting to find a linked, overallmeaning for all the words in a paragraph.
An archi-tectural view of the system is shown in Figure 2.3.1 Core NLU ComponentsAt the core of the system is a packed-forest  chartparser which builds constituents bottom-up using abest-first search strategy.
The core grammar is ahand-built, lexicalized context-free grammar, aug-mented with feature structures and feature unifica-tion.
The parser draws on a general purpose seman-tic lexicon and ontology which define a range ofword senses and lexical semantic relations.
Thecore semantic lexicon was constructed by hand andcontains more than 7000 lemmas.
It  can be alsodynamically augmented for unknown words byconsulting WordNet (Miller, 1995).To support  more robust processing as well asdomain configurability, the core system is in-formed by a variety of statistical and symbolic pre-processors.
These include several off-the-shelf sta-tisical NLP tools such as the Stanford POS tagger(Toutanova and Manning, 2000), the Stanfordnamed-entity recognizer (NER) (Finkel et al,2005) and the Stanford Parser (Klein and Manning,2003).
The output of these and other specializedpreprocessors (such as a street address recognizer)are sent  to the parser as advice.
The parser then caninclude or not include this advice (e.g., that a cer-tain phrase is a named entity) as it searches for theoptimal parse of the sentence.The result  of parsing is a frame-like semanticrepresentation that we call the Logical Form (LF).The LF representation includes semantic types,semantic roles for predicate arguments, and de-pendency relations.
Figure 3 shows an LF examplefor the sentence ?She had a left radical nephrec-tomy in 09/2007?.
In the representation, elementsthat start  with colons (e.g., :THEME) are semanticroles of ontological concepts, and role values canbe a variable to refer to another LF term.3.2 UMLS IntegrationBy far the most  critical aspect  of porting our ge-neric NLU components to the task of understand-ing clinical text  is the need for domain-specificlexical and ontologic information.
One widely usedcomprehensive resource that  can provide both isthe National Library of Medicine?s Unified Medi-cal Language System (UMLS) (Bodenreider,2004).
UMLS was integrated into or system viaMetaMap (Aronson and Lang, 2010), a tool alsodeveloped by NLM, that  can identify and rankUMLS concepts in text.Specifically, we added MetaMap as a specialkind of named entity recognizer feeding adviceinto the Parser?s input chart (see Figure 2).
We runMetaMap twice on the input  text  to obtain UMLSinformation both for the maximal constituents, andfor individual words in those constituents (e.g.,?lung cancer?, as well as ?lung?
and ?cancer?
).The lexicon constructs representations for thenew words and phrases on the fly.
Our general ap-proach for dealing with how the correspondingconcepts fit  in our system ontology uses an ontol-Core Lexicon& Semantic OntologyGrammarParserWordnetUnknown WordProcessingNew Lexical EntriesOutputChartInputChartStatistical ParserBracketing PreferencesInputNamed EntityRecognizerNameHypothesesPOSTaggingPOSHypothesesWord HypothesesMetaMap UMLSUMLSPOS/senseHypothesesLF SemanticRepresentationfor reasonersFigure 2: Front-end language processing components with MetaMap and UMLS148ogy specialization mechanism which we call on-tology grafting, whereby new branches are createdfrom third party ontological sources, and attachedto appropriate leaf nodes in our ontology.The UMLS Semantic Network and certain vo-cabularies included in the UMLS Metathesaurusdefine concept hierarchies along multiple axes.First, we established links between the 15 UMLSsemantic groups and corresponding concepts in ourontology.
Second, we selected a list of nodes fromthe SNOMED-CT and NCI hierarchies (27 and 11nodes, respectively) and formed ontologicalbranches rooted in these nodes that  we grafted ontoour ontology.Based on these processes, UMLS informationgets integrated into our LF representation.
In Fig-ure 3, the 3rd term has a role called :domain-infoand, in fact, its value is (UMLS :CUI C2222800:CONCEPT "left nephrectomy" :PREFERRED"nephrectomy of left kidney (treatment)":SEMANTIC-TYPES (TOPP) :SEMANTIC-GROUPS (PROC) :SOURCES (MEDCIN MTH))that provides detailed UMLS concept information.Here, the semantic type ?TOPP?
is a UMLS abbre-viation for ?Therapeutic or Preventive Procedure?.More details about complex issues surroundingUMLS integration into our system can be found in(Swift et al, 2010).4 Information Extraction (IE) from ClinicalText RecordsIn this section, we describe how to extract basicelements that will be used as a foundation to con-struct timelines.
We first describe our general ap-proach to extracting information from LF graphs.Then we give details specific to the various typesof information we extract in our system: variousclinical concepts, temporal concepts (points as wellas intervals), events and temporal relations.4.1 LF Pattern-based ExtractionGiven LF outputs from the NLU system describedin Section 3, we use LF pattern-based rules for in-formation extraction.
The basic structure of an ex-traction rule is a list  of LF patterns followed by aunique rule ID and the output specification.Each LF-pattern specifies a pattern against  anLF.
Variables can appear anywhere except as rolenames in different formats:?
?x - (unconstrained) match anything??
!x - match any non-null value?(?
x V1 V2 ...) - (constrained) match one of thespecified values V1,  V2, ...As an example, the extraction rule in Figure 4will match LFs that mean a person had a treatmentor a medical-diagnostic with explicit  UMLS in-formation (i.e., part of LFs in Figure 3 matches).The output specification records critical informa-tion from the extraction to be used by other rea-soners.The extraction rules have all been developed byhand.
Nevertheless, they are quite general, since a)LF patterns abstract away from lexical and syntac-tic variability in the broad class of expressions ofinterest (however, lexical and syntactic featuresmay be used if needed); and b) LF patterns makeheavy use of ontological categories, which pro-vides abstraction at the semantic level.4.2 Clinical Concept ExtractionAmong various types of concepts included in clini-cal records, we focus on concepts related toproblems/tests/treatments to build a medical his-(F V1 (:* ONT::HAVE W::HAVE) :AFFECTED V2 :THEME V3 :MOD V4 :TENSE W::PAST)(PRO V2 (:* ONT::PERSON W::SHE) :PROFORM ONT::SHE :CO-REFERENCE V0)(A V3 (:* ONT::TREATMENT W::LEFT-RADICAL-NEPHRECTOMY) :DOMAIN-INFO (UMLS .....)(F V4 (:* ONT::TIME-SPAN-REL W::IN) :OF V1 :VAL V5)(THE V5 ONT::TIME-LOC :YEAR 2007 :MONTH 9)Figure 3: LF semantic representation for ?She had a left radical nephrectomy in 09/2007?
(?x1 ?y2 (?
type1 ONT::HAVE) :AFFECTED ?y2 :THEME ?y3 :MOD ?y4)(?x2 ?y2 (?
type2 ONT::PERSON)))(?x3 ?y3 (?
type3 ONT::TREATMENT ONT::MEDICAL-DIAGNOSTIC) :DOMAIN-INFO ?
!info)List of LF patterns-extract-person-has-treatment-or-medical-diagnostic>(EVENT :type ?type1 :class occurrence :subject ?y2 :object ?y3)Unique rule IDOutput SpecificationFigure 4: An example extraction rule149tory and extract  them using extraction rules as de-scribed above.
Figure 5 shows a rule to extractsubstances by matching any LF with a substanceconcept (as mentioned already, subclasses such aspharmacologic substances, would also match).The rule in Figure 5 checks the :quantifier roleand its value (e.g., none) is used to infer the pres-ence or the absence of concepts.
Using similarrules, we extract  additional concepts such asmedical-disorders-and-conditions, physical-symptom, treatment, medical-diagnostic, medical-action and clinical-finding.
Here, medical-actionand clinical-finding are to extract concepts in abroader sense.2To cover additional concepts, wecan straightforwardly update extraction rules.4.3 Temporal Expression ExtractionTemporal expressions are also extracted in thesame way but using different  LF patterns.
We have14 rules to extract  dates and time-spans of varyinglevels of complexity; for the example in Figure 1six of these rules were applied.
Figure 6 shows LFpatterns for a rule to extract temporal expressionsof the form ?until X days/months/years ago?
; forexample, here is what the rule extracts for ?until 3days ago?
:(extraction :type time-span :context-rel (:*ont::event-time-rel w::until) :reference (time-position:context-rel (:* ont::event-time-rel w::ago) :amount 3:unit (:* ont::time-unit ont::day)))From this type of output, other reasoners caneasily access necessary information about giventemporal expressions without investigating thewhole LF representation on their own.4.4 Event ExtractionTo construct timelines, the concepts of interest(Section 4.2) and the temporal expressions (Sec-tion 4.3) should be pieced together.
For that pur-pose, it  is critical to extract events because they notonly describe situations that  happen or occur butalso represent states or circumstances where some-thing holds.
Furthermore, event features provideuseful cues to reason about  situations surroundingextracted clinical concepts.Here, we do not formally define events, but  referto (Sauri et  al., 2006) for detailed discussion aboutevents.
While events can be expressed by multiplemeans (e.g., verbs, nominalizations, and adjec-tives), our extraction rules for events focus onverbs and their features such as class, tense, aspect,and polarity.
Figure 7 shows a rule to extract  anevent  with the verb ?start?
like the one in Line 4,?She was started on Afinitor on 03/05/08?.
Theoutput specification from this rule for Line 4 willhave the :class, :tense, and :passive roles as (aspec-tual initiation), past, and true respectively.These event  features play a critical role in con-structing timelines (Section 5).
For instance, theevent  class (aspectual initiation) from applying therule in Figure 7 to Line 4 implies that  the concept?Afinitor?
(a pharmacologic-substance) is not  justsomething tried on the given date, 03/05/08,  butsomething that continued from that date.4.5 Relation Information ExtractionThe relations among extracted concepts (namely,conjoined relations between events and set rela-tions between clinical concepts) also play a keyrole in our approach.
When events or clinical con-cepts are closely linked with such relations, heuris-tically, they tend to share similar properties that areexploited in constructing timelines as described inSection 5.5 Building Timelines from Extracted ResultsExtracted clinical concepts, temporal expressions,events, and relations (Section 4) are used as a2While concept classification into certain categories is a very important task in the medical domain, sophisticatedconcept categorization like the one specified in the 2010 i2b2/VA Challenge (https://www.i2b2.org/NLP/Relations/)is not the primary goal of this paper.
We rather focus on how to associate extracted concepts with other events andtemporal expressions to build timelines.
(?x1 ?y1 (:* ont::event-time-rel w::until) :val ?val)(?x2 ?val (?
type2 ont::time-loc) :mod ?mod)(?x3 ?mod (?
type3 ont::event-time-rel) :displacement?displacement)(?x4 ?displacement (?
type4 ont::quantity) :unit ?unit:amount ?amount)(?x5 ?amount ont::number :value ?num)Figure 6: LF patterns to extract a time-span((?x1 ?y1 (?
type1 ONT::SUBSTANCE) :domain-info?info :quantifier ?quan)-extract-substance>(extraction :type substance :concept ?type1 :umlsinfo?info :ont-term ?y1 :quantifier ?quan))Figure 5: A rule to extract substances150foundation to construct timelines that  representpatients?
medical history.
In this section, we pre-sent  timeline construction processes (as shown inFigure 8), using example sentences from Section 2.Step 1: We first  make connections between eventsand clinical concepts.
In the current system, eventsand clinical concepts are extracted in separate rulesand their relations are not always explicit  in theoutput specification of the rules applied.
For in-stance, Figure 9 shows LFs for the sentence in Line7 in a graph format, using simplified LF terms forillustration.
The clinical concept ?prednisone?
andthe event  ?received?
get  extracted by differentrules and the relation between them is not explicitin their output specifications.To address such a case, for a pair of an eventand a clinical concept, we traverse LF graphs anddecide that a relation between them exists if thereis a path that  goes through certain pre-defined con-cepts that  do not separate them semantically andsyntactically (e.g., concepts of measure-units,evidence/history, development, and some proposi-tions).Step 2: Second, we find temporal expressions as-sociated with events.
This step is relativelystraightforward.
While temporal expressions andevents get  extracted separately, by investigatingtheir LFs, we can decide if a given temporal ex-pression is a modifier of an event.
In Figure 9, thetime-span-relation (i.e., ?in?)
in the dotted-line boxis a direct modifier of the event ?was treated?.Step 3: Next, we propagate the association be-tween events and temporal expressions.
That is,when the relation between an event and a temporalexpression is found, we check if the temporal ex-pression can be associated with additional eventsrelated to the event  (esp.
when the related eventsdo not have any associated temporal expression).In Figure 9, the event  ?received?
does not have atemporal expression as a modifier.
However, it  isconjoined with the event  ?was treated?
in the samepast  tense under the same speech act.
Thus, we letthe event  ?received?
share the same temporal ex-pression with its conjoined event.
Here, the con-joined relation was extracted with relation rulesdescribed in Section 4.5, which allows us to focuson only related events.Step 4: When temporal expressions do not haveconcrete time values within the expressions, weneed to designate times for them by looking intoinformation in their LFs:?Event references: The system needs to find thereferred event  and gets its time value.
For in-stance, in ?4 weeks after starting Afinitor?
(Line6),  ?starting Afinitor?
refers to a previous eventin Line 4.
The system investigates all events witha verb with the same- or sub-type of ont::startand Afinitor as its object  (active verbs) or itssubject (passive verbs).
After resolving eventreferences, additional time reference or relationcomputation may be required (e.g., computationfor ?4 weeks after?).
?Time references: Concrete times for expressionslike the above example ?N weeks after<reference-time>?
can be easily computed bychecking the time displacement  information inLFs with the reference time.
However, expres-sions such as ?N days ago?
are based on thecontext of clinical records (e.g., record creation(?x1 ?ev (?
type1 ont::start) :affected ?affected :tense ?tense :passive ?passive :progressive ?progresive:perfective ?perfective :negation ?negation)-extract-start-event>(EVENT :type ?type1 :class (aspectual initiation) :subject ?affected :object null :tense ?tense :passive?passive :progressive ?progresive :perfective ?perfective :negation ?negation :ont-term ?ev)Figure 7: An event extraction rule exampleInputs: Clinical concepts, TemporalExpressions, Events, Relations, LFsOutputs: Clinical concepts with associated datesor timespans.Steps:1.
Build links between events and clinicalconcepts2.
Find associated temporal expressions forevents3.
Propagate temporal expressions throughrelations between events when applicable4.
Compute concrete time values for temporalexpressions, taking into account the context ofclinical records5.
Compute time values for clinical conceptsbased on their associated eventsFigure 8: Pseudocode for Timeline Construction151time).
Document creation time is usually repre-sented as metadata attached to the document  it-self, or it could be retrieved from a databasewhere clinical records are stored.
In addition,previously mentioned dates or time-spans can bereferred to using pronouns (e.g., ?at  that/thistime?).
For such expressions, we heuristicallydecide that it refers to the most  recent  temporalexpression.
?Time relation: Some temporal expressions havedirectional time relations (e.g., ?until?, ?priorto?, and ?after?)
specifying intervals with openends.
When the ending time of a time span is notspecified (e.g., ?since 10/2007?
in Line 10).
Weheuristically set it from the context of the clinicalrecord such as the document creation time.Step 5: Finally, we designate or compute times onor during which the presence or the absence ofeach clinical concept is asserted.
Since temporalexpressions are associated with events, to find timevalues for clinical concepts, we first check the rela-tions between events and clinical concepts.
Whenan event with a concrete time is found for a clinicalconcept, the event?s class is examined.
For classessuch as state and occurrence, the concrete timevalue of the event  is used.
In contrast, for an aspec-tual event, we check its feature (e.g., initiation ortermination) and look for other aspectual eventsrelated to the clinical concept and compute a timespan.
For instance, regarding ?Afinitor?, Line 4and Line 9 have events with classes (aspectual ini-tiation) and (aspectual termination) respectively,which leads to a time span between the two datesin Line 4 and Line 9.
Currently, we do not resolveconflicting hypotheses.Assertion of Presence  or Absence  of ClinicalConcepts: To check if a certain concept is presentor not, we take into account quantifier information(e.g., none), the negation role values of events, andthe verb types of events (e.g., ?deny?
indicates theabsence assertion).
In addition to such informationreadily available in the output  specifications of theclinical concept- and event-extraction rules, wealso check the path (as in Step 1) that relates theclinical concepts and the events, and the quantifiersof the concepts in the path are used to computenegation values.
For instance, given ?The scanshows no evidence of lung nodules?, the quantifierof the concept  ?evidence?
indicates the absence ofthe clinical finding ?lung nodules?.6 Timeline Results and DiscussionFor the example in Section 2 (Line 1 ~ 12), we ex-tract all the instances of the clinical concepts andthe temporal expressions.
Out of 23 events, 17were extracted.
While we missed events such asstate/was (Line 5), done (Line 8), and walk/do/swim  (Line 10), our event  extraction rules can beextended to cover them if need be.Figure 10 visualizes the extraction results of theexample.
We use a web widget tool called SimileTimeline (www.simile-widgets.org/timeline/).Some property values (that  were also extracted byrules) are shown alongside some concepts (e.g.,weight  measurement).
Note that not  all extractedclinical findings are displayed in Figure 10 becausewe visualize clinical concepts only when they areassociated with temporal expressions in our LFs.For instance, the CT-scan on 05/14/08 in Line 8 isnot shown because the date was not  associatedwith it due to fragmented LFs from the Parser.Figure 9: Graph format LFs of the sentence in Line 7 -- ?She received a 5 day dose pack ofprednisone and was treated with Augmentin in 05/2008.
?152However, we were still able to extract ?no infil-trates?
and ?scan?
from a meaningful fragment.In addition to the fragmented LF issue, we planto work on temporal reasoning for concepts in thesentences without explicit temporal expressions,and the current limited event reference resolutionwill be improved.
We are also working on evalua-tion with 48 clinical records from 10 patients.
An-notated results will be created as a gold-standardand precision/recall will be measured.7 Related WorkTemporal information is of crucial importance inclinical applications, which is why it  has attracteda lot  interest over the last  two decades or more(Augusto, 2005).
Since so much clinical informa-tion is still residing in unstructured form, in par-ticular as text  in the patient?s health record, the lastdecade has seen a number of serious efforts inmedical NLP  in general (Meystre et  al., 2008) andin extracting temporal information from clinicaltext in particular.Some of this surge in interest  has been spurredby dedicated competitions on extraction of con-cepts and events from clinical text (such as thei2b2 NLP challenges).
At the same time, the evolu-tion of temporal markup languages such as Ti-meML (Sauri et al, 2006), and temporalextraction/inference competitions (such as the twoTempEval challenges,  Verhagen et  al., 2009) in thegeneral area of NLP have led to the developmentof tools such as TARSQI (Verhagen et  al., 2005)that could be adapted to the clinical domain.Although the prevailing paradigm in this area isto use superficial methods for extracting and clas-sifying temporal expressions, it has long been rec-ognized that higher level semantic processing, in-cluding discourse-level analysis, would have to beperformed to get  past the limits of the current  ap-proaches (cf.
Zhou and Hripcsak, 2007).Recent attempts to use deeper linguistic featuresinclude the work of  Bethard et  al.
(2007), whoused syntactic structure in addition to lexical andsome minor semantic features to classify temporalrelations of the type we discussed in Section 4.3.Savova and her team have also expressed interestin testing off-the-shelf deep parsers and semanticrole labelers for aiding in temporal relation identi-fication and classification (Savova et al, 2009);although we are not  aware of any temporal extrac-tion results yet, we appreciate their effort in ex-panding the TimeML annotation schema for theclinical domain, as well as their efforts in develop-ing corpora of clinical text  annotated with temporalinformation.The work of Mulkar-Mehta et  al.
(2009) alsodeserves a mention, even though they apply theirtechniques to biomedical text rather than clinicaltext.
They obtain a shallow logical form that repre-sents predicate-argument relations implicit  in thesyntax by post-processing the results of a statisticalparser.
Temporal relations are obtained from theshallow LF based on a set  of hand-built rules by anabductive inference engine.To our knowledge, however, our system is thefirst  general-purpose NLU system that produces afull, deep syntactic and semantic analysis of thetext as a prerequisite to the extraction and analysisof relevant clinical and temporal information.8 ConclusionIn this paper, we presented a prototype deep natu-ral language understanding system to constructtimelines for the medical histories of patients.
Ourapproach is generic and extensible to cover a vari-ety of narrative clinical text  records.
The resultsfrom our system are promising and they can beused to support medical decision making.9 AcknowledgementThis work was supported by the National CancerInstitute and the H. Lee Moffitt  Cancer Center andResearch Institute (Award # RC2CA1488332).Figure 10: Visualization of timeline results153ReferencesJames Allen, Donna Byron, Myroslava Dzikovska,George Ferguson, Lucian  Galescu, and AmandaStent.
2000.
An architecture for a generic dialogueshell.
Journal of Natural Language Engineering6(3):1?16.Mary Swift, Nate Blaylock, James Allen, Will deBeaumont, Lucian Galescu, and Hyuckchul Jung.2010.
Augmenting a Deep Natural Language Proc-essing System with UMLS.
Proceedings of theFourth International Symposium on Semantic Miningin Biomedicine (poster abstract)Alan R. Aronson and Fran?ois-Michel Lang.
2010.
Anoverview of MetaMap: historical perspective andrecent advances.
Journal of the American MedicalInformatics Association.
17:229-236.Juan C. Augusto.
2005.
Temporal reasoning for decisionsupport in medicine.
Artificial Intelligence in Medi-cine, 33(1): 1-24.Steven Bethard, James H.  Martin, and Sara Klingen-stein.
2007.
Timelines from Text: Identification ofSyntactic Temporal Relations.
In Proceedings of theInternational Conference on Semantic Computing(ICSC '07), 11-18.Olivier Bodenreider.
2004.
The Unified Medical Lan-guage System (UMLS): integrating biomedical ter-minology.
Nucleic Acids Research, Vol.
32.Jenny Rose Finkel, Trond Grenager, and ChristopherManning.
2005.
Incorporating Non-local Informationinto Information Extraction Systems by Gibbs Sam-pling.
Proceedings of the Annual Meeting of the As-sociation for Computational Linguistics.Dan Klein and Christopher D. Manning.
2003.
Fast Ex-act Inference with a Factored Model for Natural Lan-guage Parsing.
In Advances in Neural InformationProcessing Systems 15 (NIPS 2002), Cambridge,MA: MIT Press.S.
M. Meystre, G. K. Savova, K. C. Kipper-Schuler, J.F.
Hurdle.
2008.
Extracting information from textualdocuments in the electronic health record: a reviewof recent research.
IMIA Yearbook of Medical Infor-matics.George A. Miller.
1995.
WordNet: A lexical database forEnglish.
Communications of the ACM, 38(5).R.
Mulkar-Mehta, J.R. Hobbs, C.-C. Liu, and X.J.
Zhou.2009.
Discovering causal and temporal relations inbiomedical texts.
In AAAI Spring Symposium, 74-80.Roser Sauri, Jessica Littman, Bob Knippen, Robert Gai-zauskas, Andrea Setzer, and James Pustejovsky.2006.
TimeML annotation guidelines.
(available athttp://www.timeml.org/site/publications/timeMLdocs/annguide_1.2.1.pdf)G. Savova, S. Bethard, W. Styler, J. Martin, M. Palmer,J.
Masanz, and W. Ward.
2009.
Towards temporalrelation discovery from the clinical narrative.
Pro-ceedings of the Annual AMIA Symposium, 568-572.Michael Stacey and Carolyn McGregor.
2007.
Temporalabstraction in intelligent clinical data analysis: A sur-vey.
Artificial Intelligence in Medicine, 39.Kristina Toutanova and Christopher D. Manning.
2000.Enriching the Knowledge Sources Used in a Maxi-mum Entropy Part-of-Speech Tagger.
In Proceedingsof the Joint SIGDAT Conference on Empirical Meth-ods in Natural Language Processing and Very LargeCorpora (EMNLP/VLC-2000).M.
Verhagen, I. Mani, R. Sauri, R. Knippen, S.B.
Jang,J.
Littman, A. Rumshisky, J. Phillips, andJ.
Pustejovsky.
2005.
Automating temporal annota-tion with TARSQI.
In Proceedings of the ACL 2005on Interactive poster and demonstration sessions(ACLdemo '05), 81-84.M.
Verhagen, R. Gaizauskas, F. Schilder, M. Hepple,J.
Moszkowicz, and J. Pustejovsky.
2009.
The Tem-pEval challenge: identifying temporal relations intext .
Language Resources and Evaluation43(2):161-179.Li Zhou, Carol Friedman, Simon Parsons and GeorgeHripcsak.
2005.
System Architecture for TemporalInformation Extraction,  Representation and Reason-ing in Clinical Narrative Reports.
Proceedings of theAnnual AMIA Symposium.Li Zhou and George Hripcsak.
2007.
Temporal reason-ing with medical data - A review with emphasis onmedical natural language processing.
Journal ofBiomedical Informatics, 40.154
